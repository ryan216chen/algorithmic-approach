# 關於米勒拉賓的質數篩檢法

(題目來源:https://zerojudge.tw/ShowProblem?problemid=a121)


來源:費馬小定理

  對任意整數a，若p是質數則:  a^p ≡ a (mod p)
  若gcd(a,p) = 1,則可以化簡成: a^(p-1) ≡ 1(mod p).


而費馬小定理也存在Carmichael number使p不是質數且a和p互質,但  a^(p-1) ≡ 1(mod p)  成立.

而米勒拉賓則是利用把次方項拆成平方鏈,假設要檢查p是不是質數,通常質數都是奇數除了2才是偶數,
所以利用  a^(p-1) ≡ 1(mod p)  把p減去1變成偶數然後拆成p - 1 = 2^s * d(奇數).

a^(p-1) ≡ 1(mod p)  變成  a^(p-1) = a^(2^s*d) ≡ 1(mod p) 

代表說從a^d -> a^(2*d) -> a^(4*d) -> ... -> a^(2^s*d)一直平方上去最後一定到1
所以檢查是不是某一步會到-1,也就是餘負1,也等於p-1,等於時就代表說p有可能是質數也可能是合數,就先跳過這次的a往下個迴圈找a.

若中途都沒有出現餘數是-1,則一定不是質數.  ->  也就是在模質數情況下,平方後等於1的前一項只能是±1,因此若平方鏈中未曾出現-1,但最終得到1,即可判定p為合數.
因為  a^(p-1) ≡ 1(mod p)  存在Carmichael number使得p不一定是質數,所以米勒拉賓利用平方鏈方法檢驗.
